# Endless Runner

## 1. Автор  
Выполнила Лавицкая Александра, студентка 4 курса группы 225 ПМИ 

## 2. Краткое описание игры
Игра представляет собой бесконечный раннер от третьего лица, в котором игрок управляет чёрно-белой сферой, автоматически движущейся вперёд по трём дорожкам. Игрок может переключаться между линиями, выполнять прыжки (включая двойной), собирать бонусы и избегать препятствий. 
В игре реализована система начисления очков за игровое время и сбор бонусов, с сохранением лучшего результата между сессиями.
Препятствия представлены серыми кубами типа A и золотыми кубами типа B (вторые повернуты на (45, 45, 45), благодаря чему они напоминают пирамиды). Есть бонусы двух видов: разноцветные капсулы, восстанавливающие здоровье, и чёрные цилиндры, дающие временную неуязвимость. 
При получении урона, подборе бонусов и активации неуязвимости срабатывают соответствующие анимации изменения цвета, реализованные через Unity Animator. Игровой интерфейс отображает здоровье, скорость, очки и рекорд, а по нажатию ESC открывается меню паузы.
Дорога формируется из процедурно генерируемых сегментов, а новые бонусы и препятствия появляются по мере движения игрока, создавая эффект бесконечного пути.

## 3. Входные сцены и структура проекта  

### Главное меню  
`MainMenu.unity` - начальная сцена. Содержит название игры, информацию о разработчике, рекорд игрока и две кнопки: начало игры и выход.

### Игровая сцена  
`GameScene.unity` - основная сцена с игровым процессом. Содержит игрока, камеру, генераторы препятствий, бонусов и дороги, а также все управляющие компоненты.

### Главные управляющие скрипты  
- `GameManager.cs` - управление игровым циклом, отображение панели Game Over, остановка игрового времени, перезапуск уровня и выход в меню.
- `ScoreManager.cs` - система начисления очков и управления рекордами. Начисляет очки за игровое время и сбор бонусов, сохраняет Best score между сессиями.
- `UIManager.cs` - управление всем пользовательским интерфейсом: отображение информации во время игры, меню паузы, обновление здоровья, скорости, очков.
- `MainMenu.cs` - логика главного меню, отображение рекорда, обработка кнопок.


## 4. Описание ключевых систем проекта  

Все системы ниже - это основные компоненты игрового процесса.  
Каждая система содержит один или несколько скриптов, перечисленных отдельно.

### Система игрока  
- `PlayerRigidbodyController` - движение вперёд, смена линий в стиле Subway Surfers, прыжки.  
- `PlayerHealth` - здоровье игрока, получение урона, неуязвимость, смерть.  
- `FollowCamera` - сглаженное следование камеры за игроком.
- `PlayerAnimator` - управление анимациями через Unity Animator Controller.

**Описание работы:**  
Сфера движется вперёд автоматически. Управление игроком сводится к смене полос движения и прыжкам.  
Игрок может получать урон или временно становиться неуязвимым благодаря бонусам. При получении урона или бонусов запускаются соответствующие визуальные анимации.

### Система препятствий   
- `Obstacle` - отвечает за урон и логику уничтожения препятствий.  
- `ObstacleSpawner` - создаёт препятствия впереди игрока равномерно и с учётом безопасных интервалов.

**Особенности:**  
- препятствия не накладываются друг на друга благодаря проверкам коллизий и минимальной дистанции по Z;  
- если препятствие оказывается слишком далеко позади игрока, оно автоматически удаляется.

### Система земли  
- `GroundSpawner` — процедура создания новых сегментов дороги.  

**Функциональность:**  
- генерирует сегменты по мере движения вперёд;  
- старые сегменты удаляются, когда оказываются далеко позади игрока;  
- создаётся бесконечная дорога, по которой движется игрок.

### Система бонусов  
- `BonusSpawner` - генерация бонусов в свободных дорожках.  
- `BonusPickup` - логика активации бонуса при столкновении с игроком.

**Типы бонусов:**
1. **Heal Bonus (разноцветные капсулы)**  
   - восстанавливает здоровье на фиксированное значение;  
   - здоровье не превышает максимума;
   - при подборе начисляет 5 очков;
   - запускает анимацию получения бонуса (мигание зелёным).

2. **Invulnerability Bonus (чёрный цилиндр)**  
   - даёт временную неуязвимость (игрок при этом становится другого цвета);  
   - игрок не получает урон от препятствий;  
   - неуязвимость автоматически выключается через несколько секунд;
   - при подборе начисляет 8 очков;
   - активирует длительную анимацию неуязвимости (мерцание голубым, синим и фиолетовым); анимация заканчивается, когда прекращается действие неуязвимости.

**Важно:**  
Бонусы также не накладываются друг на друга при появлении - используется сферическая коллизия с проверкой свободного места.

### Система скорости (динамическое ускорение игры)  
- `GameSpeedManager`  

**Особенности:**
- скорость игрока растёт с течением времени;  
- UI выводит текущую скорость в формате `12.0` с точкой;  
- текст скорости коротко мигает при изменении скорости, привлекая внимание игрока.

### Система UI  
- `UIManager` - отвечает за обновление отображения здоровья, скорости, очков и рекорда, управление меню паузы.
- `MainMenu` - управление главным меню, отображение Best score.

**Элементы интерфейса:**
1. **Главное меню**: название игры, информация о разработчике, Best score, кнопки START GAME и QUIT.
2. **Информация во время игры**: здоровье игрока, текущая скорость, текущие очки (Score), рекорд (Best).
3. **Меню паузы**: появляется при нажатии ESC, останавливает время игры, кнопки RESUME и RETURN TO MAIN MENU.
4. **Game Over экран**: отображается при смерти игрока, показывает финальные очки и рекорд, кнопки RESTART и RETURN TO MAIN MENU.

### Система очков и рекордов
- `ScoreManager` - централизованное управление начислением очков и сохранением рекордов.

**Функциональность:**
- Начисление очков каждые 15 секунд (настраиваемый интервал)
- Дополнительные очки за сбор бонусов: +5 за лечение, +8 за неуязвимость (тут значения тоже настраиваются)
- Автоматическое обновление Best score при превышении текущего рекорда
- Сохранение Best score между запусками игры через PlayerPrefs
- Синхронизация отображения очков во всех UI элементах (Best в игровом интерфейсе показывает предыдущий рекорд, новый рекорд отобразится только после сохранения)

### Система анимаций
- `PlayerAnimator` - контроллер анимаций через Unity Animator
- `PlayerAnimatorController` - граф состояний анимаций

**Анимации:**
1. **Получение урона**: мигание красным цветом
2. **Получение бонуса здоровья**: мигание зелёным цветом
3. **Состояние неуязвимости**: мигание голубым, синим и фиолетовым цветом

**Animator Controller содержит:**
- Параметры: Damage (Trigger), HealBonus (Trigger), IsInvulnerable (Bool)
- Состояния: Idle, Player_Damage, Player_HealBonus, Player_Invulnerability
- Плавные переходы между состояниями

## 5. Дополнительные функции

### Ускорение игры со временем  
Скорость игрока плавно увеличивается, повышая сложность и динамику геймплея.  
UI выводит скорость и визуально выделяет её изменение.

### Два типа бонусов  
**Heal Bonus (разноцветные капсулы):** восполняет здоровье.  
**Invulnerability Bonus (чёрный цилиндр):** даёт временную неуязвимость.  

Оба бонуса корректно взаимодействуют с системой препятствий (не накладываются на них) и удаляются по истечению времени или после подбора.

### Визуальные анимации через Unity Animator
- Анимации получения урона и бонусов
- Граф состояний с триггерами и булевыми параметрами
- Визуальная обратная связь для всех игровых событий

## 6. Ссылки на материалы  
При работе использовались лекции курса "Основы разработки компьютерных игр", а также общие материалы Unity-туториалов:

- Документация Unity по физике и столкновениям
https://docs.unity3d.com/Manual/PhysicsSection.html

- Документация Unity по Rigidbody
https://docs.unity3d.com/ScriptReference/Rigidbody.html

- Unity Scripting API - MonoBehaviour
https://docs.unity3d.com/ScriptReference/MonoBehaviour.html

- Примеры корутин (для реализации неуязвимости)
https://docs.unity3d.com/Manual/Coroutines.html

- Unity Animator Controller документация
https://docs.unity3d.com/Manual/class-AnimatorController.html

- Unity PlayerPrefs для сохранения данных
https://docs.unity3d.com/ScriptReference/PlayerPrefs.html

- Unity UI System
https://docs.unity3d.com/Packages/com.unity.ugui@1.0/manual/index.html

Все механики адаптированы, переработаны и расширены под требования проекта.

## 7. Изменения по сравнению с HomeAssignment_1
1. **Полноценная система очков и рекордов**
   - Начисление очков за игровое время
   - Дополнительные очки за сбор бонусов (лечение и неуязвимость)
   - Сохранение Best score между запусками игры через PlayerPrefs
   - Отображение текущих очков и рекорда в реальном времени

2. **Новый главный экран**
   - Создана отдельная сцена MainMenu с навигацией между игровыми сценами и панель главного меню
   - В панели главного меню отображаются информация о разработчике, Best score из сохранений и кнопки START GAME и QUIT

3. **Расширенный интерфейс игры**
   - Добавлено отображение текущих очков и Best score в игровом экране
   - Реализовано меню паузы по нажатию ESC с остановкой игрового времени
   - Кнопки RESUME и RETURN TO MAIN MENU в меню паузы

4. **Улучшенная панель Game Over**
   - Добавлено отображение финальных очков и Best score
   - Раньше при смерти игрока выводилась Game Over панель с кнопками RESTART и QUIT. Теперь кнопка QUIT заменена на RETURN TO MAIN MENU

5. **Усовершенствованная система визуальной обратной связи**
   - Реализована полноценная система анимаций через Unity Animator
   - Добавлены анимации: получение урона (мигание красным), подбор бонуса здоровья (мигание зелёным)
   - Улучшена анимация неуязвимости: циклическое мерцание разными цветами вместо статичного изменения цвета
   - Создан Animator Controller с графом состояний и переходами